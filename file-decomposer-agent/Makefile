.PHONY: help install dev-install test lint format run-demo run-simple clean

help: ## æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
	@echo "å¤§æ–‡ä»¶åˆ†è§£å’Œç†è§£ Agent - å¯ç”¨å‘½ä»¤:"
	@echo ""
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'
	@echo ""

install: ## å®‰è£…é¡¹ç›®ä¾èµ–
	uv sync

dev-install: ## å®‰è£…å¼€å‘ä¾èµ–
	uv sync --dev

test: ## è¿è¡Œæµ‹è¯•
	uv run pytest tests/

lint: ## è¿è¡Œä»£ç æ£€æŸ¥
	uv run flake8 src/
	uv run mypy src/

format: ## æ ¼å¼åŒ–ä»£ç 
	uv run black src/ tests/ examples/
	uv run isort src/ tests/ examples/

run-demo: ## è¿è¡Œå®Œæ•´æ¼”ç¤º
	@echo "æ­£åœ¨å¯åŠ¨å®Œæ•´æ¼”ç¤º..."
	uv run demo_file_decomposition.py

run-simple: ## è¿è¡Œç®€å•æ¼”ç¤º
	@echo "æ­£åœ¨å¯åŠ¨ç®€å•æ¼”ç¤º..."
	uv run simple_demo.py

run-interactive: ## è¿è¡Œäº¤äº’æ¨¡å¼
	@echo "å¯åŠ¨äº¤äº’æ¨¡å¼..."
	@echo "ä½¿ç”¨æ–¹æ³•: uv run main <æ–‡ä»¶è·¯å¾„> [--question 'é—®é¢˜']"
	uv run main --help

quickstart: ## å¿«é€Ÿå¯åŠ¨
	@echo "æ­£åœ¨å¯åŠ¨å¿«é€Ÿå¼€å§‹å‘å¯¼..."
	uv run quickstart.py

setup-env: ## è®¾ç½®ç¯å¢ƒå˜é‡
	@if [ ! -f .env ]; then \
		echo "åˆ›å»º .env æ–‡ä»¶..."; \
		cp .env.example .env; \
		echo "è¯·ç¼–è¾‘ .env æ–‡ä»¶å¹¶è®¾ç½®æ‚¨çš„ API å¯†é’¥"; \
	else \
		echo ".env æ–‡ä»¶å·²å­˜åœ¨"; \
	fi

clean: ## æ¸…ç†ä¸´æ—¶æ–‡ä»¶
	find . -type d -name "__pycache__" -exec rm -rf {} +
	find . -type f -name "*.pyc" -delete
	find . -type f -name "*.pyo" -delete
	find . -type f -name "*.orig" -delete
	find . -type f -name "*.rej" -delete
	find . -type d -name ".pytest_cache" -exec rm -rf {} +
	find . -type d -name "*.egg-info" -exec rm -rf {} +

check: ## æ£€æŸ¥é¡¹ç›®çŠ¶æ€
	@echo "ğŸ” é¡¹ç›®çŠ¶æ€æ£€æŸ¥"
	@echo "================"
	@echo "Python ç‰ˆæœ¬:"
	@uv run python --version
	@echo ""
	@echo "ä¾èµ–åŒ…:"
	@uv pip list
	@echo ""
	@echo "é¡¹ç›®æ–‡ä»¶:"
	@find src/ -name "*.py" | wc -l | xargs echo "Python æ–‡ä»¶:"
	@find tests/ -name "*.py" | wc -l | xargs echo "æµ‹è¯•æ–‡ä»¶:"
	@echo ""
	@echo "ç¯å¢ƒé…ç½®:"
	@if [ -f .env ]; then echo "âœ… .env æ–‡ä»¶å­˜åœ¨"; else echo "âš ï¸  .env æ–‡ä»¶ä¸å­˜åœ¨"; fi